Migrating to zustand for state management